<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/work/dry_run_integration.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/work/dry_run_integration.py" />
              <option name="updatedContent" value="import sys, traceback&#10;sys.path.append(r&quot;C:\Users\chorg\Downloads\books-pipeline-main\books-pipeline-main&quot;)&#10;# AÃ±adir carpeta src al path para que imports locales como `import utils_quality` funcionen&#10;sys.path.insert(0, r&quot;C:\Users\chorg\Downloads\books-pipeline-main\books-pipeline-main\src&quot;)&#10;from src import integrate_pipeline as ip&#10;&#10;def main():&#10;    try:&#10;        print('MODULE OK', ip.__file__)&#10;        gr, gb = ip._load_sources()&#10;        print('LOADED gr', gr.shape, 'gb', gb.shape)&#10;        grn, gbn = ip._normalize_frames(gr, gb)&#10;        print('NORMALIZED grn cols', len(grn.columns), 'gbn cols', len(gbn.columns))&#10;        merged = ip._merge_sources(grn, gbn)&#10;        print('MERGED shape', merged.shape)&#10;        print('MERGED cols count', len(merged.columns))&#10;        detail = ip._build_book_source_detail(grn, gbn)&#10;        print('DETAIL shape', detail.shape)&#10;        merged_for_dim = merged[merged['_source_type'] != 'gb_only'].copy() if isinstance(merged, type(merged)) else merged&#10;        dim = ip._build_dim_from_merged(merged_for_dim)&#10;        print('DIM shape', dim.shape)&#10;        if not dim.empty:&#10;            print('DIM sample keys', list(dim.iloc[0].to_dict().keys())[:30])&#10;    except Exception as e:&#10;        print('ERROR:', str(e))&#10;        traceback.print_exc()&#10;&#10;if __name__ == '__main__':&#10;    main()&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/work/read_parquets.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/work/read_parquets.py" />
              <option name="updatedContent" value="import pandas as pd&#10;from pathlib import Path&#10;p = Path(r&quot;C:\Users\chorg\Downloads\books-pipeline-main\books-pipeline-main\standard&quot;)&#10;print('standard exists:', p.exists())&#10;for f in sorted(p.glob('*.parquet')):&#10;    print('Found:', f.name)&#10;    try:&#10;        df = pd.read_parquet(f)&#10;        print('  shape', df.shape)&#10;        print('  columns', df.columns.tolist())&#10;        if not df.empty:&#10;            print('  first row sample:')&#10;            row = df.iloc[0].to_dict()&#10;            for k in list(row.keys())[:40]:&#10;                print('    ',k,':', row.get(k))&#10;    except Exception as e:&#10;        print('  read error:', repr(e))&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/work/run_integrate.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/work/run_integrate.py" />
              <option name="updatedContent" value="import sys, traceback&#10;sys.path.append(r&quot;C:\Users\chorg\Downloads\books-pipeline-main\books-pipeline-main&quot;)&#10;sys.path.insert(0, r&quot;C:\Users\chorg\Downloads\books-pipeline-main\books-pipeline-main\src&quot;)&#10;from src import integrate_pipeline as ip&#10;&#10;def main():&#10;    try:&#10;        print('Calling integrate()...')&#10;        ip.integrate()&#10;        print('integrate() finished')&#10;    except Exception as e:&#10;        print('ERROR during integrate:', e)&#10;        traceback.print_exc()&#10;&#10;if __name__ == '__main__':&#10;    main()&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>